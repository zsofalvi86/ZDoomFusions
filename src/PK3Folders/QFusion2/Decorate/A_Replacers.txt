Actor PPE_WeaponSpawnerBase : CustomInventory
{
	+DONTGIB +NOTONAUTOMAP
}

Actor PPE_ChainsawSpawner : PPE_WeaponSpawnerBase replaces Chainsaw
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 ACS_NamedExecuteWithResult("SetSpawn",6) //use WithResult otherwise it'll run in parellel
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",6) == 5,"Spawn5")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",6) == 4,"Spawn4")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",6) == 3,"Spawn3")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",6) == 2,"Spawn2")
		TNT1 A 0 A_SpawnItem("PPE_ChainsawSpawn")
		stop
	Spawn2:
		TNT1 A 0 A_SpawnItem("PPE_ChaingunSpawn_BB")
		stop
	Spawn3:
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",0) == 3,"Spawn33")
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",0) == 2,"Spawn32")
		TNT1 A 0 A_SpawnItem("PPE_SuperNailgunSpawn_BN")
		stop
	Spawn32:
		TNT1 A 0 A_SpawnItem("PPE_IonRipperSpawn_BN")
		stop
	Spawn33:
		TNT1 A 0 A_SpawnItem("PPE_HyperblasterSpawn_BN")
		stop
	Spawn4:
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 3,"Spawn43")
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 2,"Spawn42")
		TNT1 A 0 A_SpawnItem("PPE_IonRipperSpawn_BC")
		stop
	Spawn42:
		TNT1 A 0 A_SpawnItem("PPE_HyperblasterSpawn_BC")
		stop
	Spawn43:
		TNT1 A 0 A_SpawnItem("PPE_LaserCannonSpawn_BC")
		stop
	Spawn5:
		TNT1 A 0 A_SpawnItem("PPE_ChainsawSpawn")
		stop
	}
}

Actor PPE_ShotgunSpawner : PPE_WeaponSpawnerBase replaces Shotgun
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 ACS_NamedExecuteWithResult("SetSpawn",0) //use WithResult otherwise it'll run in parellel
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",0) == 3,"Spawn3")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",0) == 2,"Spawn2")
		TNT1 A 0 A_SpawnItem("PPE_ShotgunSpawn_S1")
		stop
	Spawn2:
		TNT1 A 0 A_SpawnItem("PPE_ShotgunSpawn_S2")
		stop
	Spawn3:
		TNT1 A 0 A_SpawnItem("PPE_GrenadeLauncherSpawn_SM")
		stop
	Drop:
		TNT1 A 0
		TNT1 A 0 A_DropItem("PPE_Shotgun")
		stop
	}
}

Actor PPE_SuperShotgunSpawner : PPE_WeaponSpawnerBase replaces SuperShotgun
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 ACS_NamedExecuteWithResult("SetSpawn",1)
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",1) == 3,"Spawn3")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",1) == 2,"Spawn2")
		TNT1 A 0 A_SpawnItem("PPE_SuperShotgunSpawn_S2")
		stop
	Spawn2:
		TNT1 A 0 A_SpawnItem("PPE_RocketLauncherSpawn_SM")
		stop
	Spawn3:
		TNT1 A 0 A_SpawnItem("PPE_PhalanxSpawn")
		stop
	}
}

Actor PPE_ChaingunSpawner : PPE_WeaponSpawnerBase replaces Chaingun
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 ACS_NamedExecuteWithResult("SetSpawn",2)
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",2) == 4,"Spawn4")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",2) == 3,"Spawn3")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",2) == 2,"Spawn2")
		TNT1 A 0 A_SpawnItem("PPE_SuperNailgunSpawn_BN")
		stop
	Spawn2:
		TNT1 A 0 A_SpawnItem("PPE_ChaingunSpawn_BB")
		stop
	Spawn3:
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 3,"Spawn33")
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 2,"Spawn32")
		TNT1 A 0 A_SpawnItem("PPE_IonRipperSpawn_BC")
		stop
	Spawn32:
		TNT1 A 0 A_SpawnItem("PPE_HyperblasterSpawn_BC")
		stop
	Spawn33:
		TNT1 A 0 A_SpawnItem("PPE_LaserCannonSpawn_BC")
		stop
	Spawn4:
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",0) == 3,"Spawn43")
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",0) == 2,"Spawn42")
		TNT1 A 0 A_SpawnItem("PPE_SuperNailgunSpawn_BN")
		stop
	Spawn42:
		TNT1 A 0 A_SpawnItem("PPE_IonRipperSpawn_BN")
		stop
	Spawn43:
		TNT1 A 0 A_SpawnItem("PPE_HyperblasterSpawn_BN")
		stop
	Drop:
		TNT1 A 0
		TNT1 A 0 A_DropItem("PPE_Chaingun")
		stop
	}
}

Actor PPE_RocketLauncherSpawner : PPE_WeaponSpawnerBase replaces RocketLauncher
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 ACS_NamedExecuteWithResult("SetSpawn",3)
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",3) == 5,"Spawn5")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",3) == 4,"Spawn4")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",3) == 3,"Spawn3")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",3) == 2,"Spawn2")
		TNT1 A 0 A_SpawnItem("PPE_GrenadeLauncherSpawn_RR")
		stop
	Spawn2:
		TNT1 A 0 A_SpawnItem("PPE_RocketLauncherSpawn_RR")
		stop
	Spawn3:
		TNT1 A 0 A_SpawnItem("PPE_RailgunSpawn")
		stop
	Spawn4:
		TNT1 A 0 A_SpawnItem("PPE_RocketLauncherSpawn_RR")
		stop
	Spawn5:
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",4) == 2,"Spawn52")
		TNT1 A 0 A_SpawnItem("PPE_ThunderboltSpawn_RP")
		stop
	Spawn52:
		TNT1 A 0 A_SpawnItem("PPE_PlasmaGunSpawn_RP")
		stop
	}
}

Actor PPE_PlasmaGunSpawner : PPE_WeaponSpawnerBase replaces PlasmaRifle
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 ACS_NamedExecuteWithResult("SetSpawn",4)
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",4) == 5,"Spawn5")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",4) == 4,"Spawn4")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",4) == 3,"Spawn3")
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 3,"Spawn13")
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 2,"Spawn12")
		TNT1 A 0 A_SpawnItem("PPE_IonRipperSpawn_CC")
		stop
	Spawn12://Also22
		TNT1 A 0 A_SpawnItem("PPE_HyperblasterSpawn_CC")
		stop
	Spawn13://Also23
		TNT1 A 0 A_SpawnItem("PPE_LaserCannonSpawn_CC")
		stop
	Spawn3:
		TNT1 A 0 A_SpawnItem("PPE_ChaingunSpawn_CB")
		stop
	Spawn4:
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",2) == 2,"Spawn42")
		TNT1 A 0 A_SpawnItem("PPE_ThunderboltSpawn_CC")
		stop
	Spawn42:
		TNT1 A 0 A_SpawnItem("PPE_PlasmaGunSpawn_CC")
		stop
	Spawn5:
		TNT1 A 0 A_SpawnItem("PPE_SuperNailgunSpawn_CN")
		stop
	}
}

Actor PPE_BFGSpawner : PPE_WeaponSpawnerBase replaces BFG9000
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 ACS_NamedExecuteWithResult("SetSpawn",5)
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",5) == 3,"Spawn3")
		TNT1 A 0 A_JumpIf(CallAcs("GetSpawn",5) == 2,"Spawn2")
		TNT1 A 0 A_SpawnItem("PPE_ThunderboltSpawn_CP")
		stop
	Spawn2:
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 3,"Spawn23")
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 2,"Spawn22")
		TNT1 A 0 A_SpawnItem("PPE_BFGQ3Spawn_CC")
		stop
	Spawn22:
		TNT1 A 0 A_SpawnItem("PPE_BFGQ2Spawn_CC")
		stop
	Spawn23:
		TNT1 A 0 A_SpawnItem("PPE_MjolnirSpawn_CC")
		stop
	Spawn3:
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 3,"Spawn33")
		TNT1 A 0 A_JumpIf(CallAcs("GetVariant",1) == 2,"Spawn32")
		TNT1 A 0 A_SpawnItem("PPE_BFGQ3Spawn_CP")
		stop
	Spawn32:
		TNT1 A 0 A_SpawnItem("PPE_BFGQ2Spawn_CP")
		stop
	Spawn33:
		TNT1 A 0 A_SpawnItem("PPE_MjolnirSpawn_CP")
		stop
	}
}

Actor PPE_WeaponSpawnBase
{
	var int user_spawn;
	+DONTGIB +NOTONAUTOMAP
}

Actor PPE_BulSpawn : PPE_WeaponSpawnBase { }
Actor PPE_ShelSpawn : PPE_WeaponSpawnBase { }
Actor PPE_RcktSpawn : PPE_WeaponSpawnBase { }
Actor PPE_CelSpawn : PPE_WeaponSpawnBase { }

Actor PPE_ChainsawSpawn : PPE_WeaponSpawnBase
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Chainsaw")
        TNT1 A 100
		stop
	}
}

Actor PPE_SuperShotgunSpawn_S1 : PPE_ShelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_SuperShotgun")
        TNT1 A 100
		stop
	}
}

Actor PPE_SuperShotgunSpawn_S2 : PPE_SuperShotgunSpawn {}

Actor PPE_SuperNailgunSpawn_BN : PPE_ShelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_SuperNailgun")
        TNT1 A 100
		stop
	}
}

Actor PPE_SuperNailgunSpawn_CN : PPE_CelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_SuperNailgun")
        TNT1 A 100
		stop
	}
}

Actor PPE_ChaingunSpawn_BB : PPE_BulSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Chaingun")
        TNT1 A 100
		stop
	}
}

Actor PPE_ChaingunSpawn_CB : PPE_CelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Chaingun")
        TNT1 A 100
		stop
	}
}

Actor PPE_GrenadeLauncherSpawn_RR : PPE_RcktSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_GrenadeLauncher")
        TNT1 A 100
		stop
	}
}

Actor PPE_GrenadeLauncherSpawn_SM : PPE_ShelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_GrenadeLauncher")
        TNT1 A 100
		stop
	}
}

Actor PPE_RocketLauncherSpawn_RR : PPE_RcktSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_RocketLauncher")
        TNT1 A 100
		stop
	}
}

Actor PPE_RocketLauncherSpawn_SM : PPE_ShelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_RocketLauncher")
        TNT1 A 100
		stop
	}
}

Actor PPE_IonRipperSpawn_BN : PPE_BulSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_IonRipper")
        TNT1 A 100
		stop
	}
}

Actor PPE_IonRipperSpawn_BC : PPE_IonRipperSpawn_BN {}

Actor PPE_IonRipperSpawn_CC : PPE_CelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_IonRipper")
        TNT1 A 100
		stop
	}
}

Actor PPE_HyperblasterSpawn_BN : PPE_BulSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Hyperblaster")
        TNT1 A 100
		stop
	}
}

Actor PPE_HyperblasterSpawn_BC : PPE_HyperblasterSpawn_BN {}

Actor PPE_HyperblasterSpawn_CC : PPE_CelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Hyperblaster")
        TNT1 A 100
		stop
	}
}

Actor PPE_PlasmaGunSpawn_CC : PPE_CelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_PlasmaGun")
        TNT1 A 100
		stop
	}
}

Actor PPE_PlasmaGunSpawn_RP : PPE_RcktSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_PlasmaGun")
        TNT1 A 100
		stop
	}
}

Actor PPE_ThunderboltSpawn_CC : PPE_CelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Thunderbolt")
        TNT1 A 100
		stop
	}
}

Actor PPE_ThunderboltSpawn_RP : PPE_RcktSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Thunderbolt")
        TNT1 A 100
		stop
	}
}

Actor PPE_RailgunSpawn : PPE_BulSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Railgun")
        TNT1 A 100
		stop
	}
}

Actor PPE_PhalanxSpawn : PPE_BulSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Phalanx")
        TNT1 A 100
		stop
	}
}

Actor PPE_BFGQ2Spawn_CC : PPE_CelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Bfg10k")
        TNT1 A 100
		stop
	}
}

Actor PPE_BFGQ2Spawn_CP : PPE_BFGQ2Spawn_CC {}

Actor PPE_BFGQ3Spawn : PPE_CelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_Bfg10k")
        TNT1 A 100
		stop
	}
}

Actor PPE_BFGQ3Spawn_CP : PPE_BFGQ3Spawn_CC {}

Actor PPE_MjolnirSpawn_CC : PPE_CelSpawn
{
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 0 A_SpawnItem("PPE_DarkMatterGun")
        TNT1 A 100
		stop
	}
}

Actor PPE_MjolnirSpawn_CP : PPE_MjolnirSpawn_CC {}